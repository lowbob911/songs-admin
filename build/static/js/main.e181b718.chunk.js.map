{"version":3,"sources":["pages/dashboard/SongsList.js","pages/dashboard/Dashboard.js","components/Loader.js","App.js","index.js"],"names":["SongsList","songs","onSelect","className","scope","map","song","number","title","Button","variant","onClick","key","MODE_NEW","MODE_UPDATE","previewStyles","Dashboard","params","useState","setSongs","currentKey","setCurrentKey","mode","setMode","setTitle","text","setText","userText","setUserText","validationErrors","setValidationErrors","populateSong","updated","Date","now","validateForm","errors","useEffect","songsRef","ref","db","onValue","snapshot","fetchedSongs","forEach","s","push","val","textToSet","getCurrentContent","getPlainText","replace","a","match","EditorState","createWithText","htmlFor","type","id","placeholder","value","onChange","event","target","editorState","Object","keys","length","find","set","then","alert","updateSong","window","confirm","remove","mostViewedPosts","query","orderByChild","startAt","songsToUpdate","deleteSong","Math","max","filter","nextKey","createSong","srcDoc","Loader","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","App","setDb","app","initializeApp","getDatabase","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e181b718.chunk.js","sourcesContent":["import Button from \"react-bootstrap/Button\";\r\n\r\nexport default function SongsList({songs, onSelect}) {\r\n    return (\r\n        <table className=\"table\">\r\n            <thead>\r\n            <tr>\r\n                <th scope=\"col\">#</th>\r\n                <th scope=\"col\">Name</th>\r\n                <th scope=\"col\">Action</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            {songs.map(song => (\r\n                <tr key={song.key}>\r\n                    <th>{song.number}</th>\r\n                    <td>{song.title}</td>\r\n                    <td>\r\n                        <Button variant=\"primary\" onClick={() => onSelect(song)}>Select</Button>\r\n                    </td>\r\n                </tr>\r\n            ))}\r\n            </tbody>\r\n        </table>\r\n    )\r\n}\r\n","import React, {useEffect, useState} from \"react\";\r\nimport { onValue, ref, set, remove, query, orderByChild, startAt} from \"firebase/database\";\r\nimport {Editor, EditorState} from 'draft-js';\r\nimport SongsList from \"./SongsList\";\r\nimport Button from \"react-bootstrap/Button\";\r\n\r\nconst MODE_NEW = \"NEW\";\r\nconst MODE_UPDATE = \"UPDATE\";\r\n\r\nconst chords = `span.chunk { position: relative; display: inline-flex; flex-direction: column; vertical-align: bottom; } span.chunk:before { font-size: 0.6em; content: attr(data-chord); position: relative; vertical-align: bottom;`;\r\nconst previewStyles = `div {margin: 30px 20px; text-align: center; white-space: pre-wrap;} ${chords}`;\r\n\r\nexport default function Dashboard(params) {\r\n    const [songs, setSongs] = useState([]);\r\n\r\n    const [currentKey, setCurrentKey] = useState(null);\r\n    const [mode, setMode] = useState(null);\r\n    const [title, setTitle] = useState(\"\");\r\n    const [text, setText] = useState(\"\");\r\n    const [userText, setUserText] = useState(\"\");\r\n\r\n    const [validationErrors, setValidationErrors] = useState({});\r\n\r\n    useEffect(() => {\r\n        const songsRef = ref(params.db, 'songs');\r\n        onValue(songsRef, (snapshot) => {\r\n            const fetchedSongs = [];\r\n            snapshot.forEach(s => {\r\n                fetchedSongs.push({...s.val(), key: s.key});\r\n            });\r\n            setSongs(fetchedSongs);\r\n        });\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        let textToSet = \"\";\r\n        if (userText) {\r\n            textToSet = userText.getCurrentContent().getPlainText().replace(/{.*?{!}/g, a => {\r\n                return `<span class=\"chunk\" data-chord=\"${a.match(/{([^!]*?(?=}))/)[1]}\">${a.match(/}(.*?(?={!}))/)[1]}</span>`\r\n            })\r\n        }\r\n        setText(textToSet);\r\n    }, [userText]);\r\n\r\n    function setCurrentSong(song){\r\n        setMode(MODE_UPDATE);\r\n        setCurrentKey(song.key);\r\n        setTitle(song.title);\r\n\r\n        const text = song.text.replace(/<span class=\"chunk\".*?<\\/span>/g, function(a){\r\n            return `{${a.match(/data-chord=\"(.*?(?=\"))/)[1]}}${a.match(/<span class=\"chunk\".*>(.*?(?=<))/)[1]}{!}`;\r\n        });\r\n\r\n        setUserText(EditorState.createWithText(text));\r\n    }\r\n\r\n    function setCreateMode() {\r\n        setMode(MODE_NEW);\r\n        setTitle(\"\");\r\n        setUserText(EditorState.createWithText(\"\"));\r\n        setCurrentKey(null);\r\n    }\r\n\r\n    function updateSong() {\r\n        if(currentKey) {\r\n            const errors = validateForm();\r\n            setValidationErrors(errors);\r\n            if(Object.keys(errors).length > 0) {\r\n                return;\r\n            }\r\n\r\n            const song = {...songs.find(s => s && s.key === currentKey)};\r\n\r\n            populateSong(song);\r\n\r\n            set(ref(params.db, 'songs/' + currentKey), song)\r\n                .then(() => {\r\n                    alert(\"Updated\")\r\n                });\r\n        }\r\n    }\r\n\r\n    function createSong() {\r\n        if(mode === MODE_NEW) {\r\n            const errors = validateForm();\r\n            setValidationErrors(errors);\r\n            if(Object.keys(errors).length > 0) {\r\n                return;\r\n            }\r\n\r\n            const nextNumber = (songs.length > 0 ? Math.max(...songs.filter(s => s.number).map(s => s.number)) : 0) + 1;\r\n            const song = {\r\n                number: nextNumber\r\n            };\r\n            populateSong(song);\r\n\r\n            const nextKey = (songs.length > 0 ? Math.max(...songs.filter(s => s.key).map(s => s.key)) : 0) + 1;\r\n            set(ref(params.db, 'songs/' + nextKey), song)\r\n                .then(() => {\r\n                    alert(\"Created\");\r\n                    setMode(MODE_UPDATE);\r\n                    setCurrentKey(nextKey);\r\n                });\r\n        }\r\n    }\r\n\r\n    function populateSong(song) {\r\n        song.title = title;\r\n        song.text = text;\r\n        song.updated = Date.now()\r\n    }\r\n\r\n    function validateForm() {\r\n        const errors = {};\r\n\r\n        if (!title) {\r\n            errors.title = true;\r\n        }\r\n\r\n        if(!text) {\r\n            errors.text = true;\r\n        }\r\n\r\n        return errors;\r\n    }\r\n\r\n    function deleteSong(key) {\r\n        if(window.confirm(\"Are you sure want to delete Song?\")) {\r\n            const song = {...songs.find(s => s.key === key)};\r\n            remove(ref(params.db, 'songs/' + key))\r\n                .then(() => {\r\n                    alert(\"deleted!\");\r\n                    setCurrentKey(null);\r\n                    setTitle(\"\");\r\n                    setUserText(\"\");\r\n\r\n                    const songsRef = ref(params.db, 'songs');\r\n                    const mostViewedPosts = query(songsRef, orderByChild('number'), startAt(song.number+1));\r\n\r\n                    let songsToUpdate = [];\r\n                    onValue(mostViewedPosts, (snapshot) => {\r\n                        snapshot.forEach((snapshot) => {\r\n                            songsToUpdate.push({key: snapshot.key, val: snapshot.val()});\r\n                        });\r\n                    });\r\n\r\n                    songsToUpdate.forEach((s) => {\r\n                        const val = s.val;\r\n                        val.number = val.number - 1;\r\n                        val.updated = Date.now();\r\n\r\n                        set(ref(params.db, 'songs/' + s.key), val);\r\n                    });\r\n                })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n            <div className=\"row\">\r\n                <div className=\"col-12 col-lg-4\">\r\n                    <div className=\"card\">\r\n                        <h5 className=\"card-header\">\r\n                            Songs List\r\n                            <Button className=\"float-end\" variant=\"success\" onClick={setCreateMode}>Create</Button>\r\n                        </h5>\r\n                        <div className=\"card-body\">\r\n                            <SongsList\r\n                                songs={songs}\r\n                                onSelect={setCurrentSong}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-12 col-lg-4\">\r\n                    {(mode === MODE_NEW || (mode === MODE_UPDATE && currentKey)) && (\r\n                        <div className=\"card\">\r\n                            <h5 className=\"card-header\">\r\n                                {mode === MODE_NEW ? 'Create Song' : 'Update Song '+title}\r\n                            </h5>\r\n                            <div className=\"card-body\">\r\n                                <div>\r\n                                    <label htmlFor=\"titleInput\" className=\"form-label\">Title:</label>\r\n                                    <input type=\"text\" className={`form-control ${validationErrors.title && 'is-invalid'}`} id=\"titleInput\"\r\n                                           placeholder=\"Song Title\" value={title}\r\n                                           onChange={(event) => setTitle(event.target.value)}/>\r\n                                    <div id=\"validationServer05Feedback\" className=\"invalid-feedback\">\r\n                                        Should not be empty\r\n                                    </div>\r\n                                </div>\r\n                                <div>\r\n                                    Text:\r\n                                    <div className={`${validationErrors.text && 'is-invalid'}`}>\r\n                                        <Editor editorState={userText}\r\n                                                onChange={setUserText}\r\n                                                className={\"test\"}\r\n                                        />\r\n                                    </div>\r\n                                    <div id=\"validationServer05Feedback\" className=\"invalid-feedback\">\r\n                                        Should not be empty\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-1 text-center\">\r\n                                    {mode === MODE_UPDATE &&\r\n                                    <>\r\n                                        <Button variant=\"primary\" className=\"me-2\" onClick={() => updateSong(currentKey)}>Update</Button>\r\n                                        <Button variant=\"danger\" onClick={() => deleteSong(currentKey)}>Delete</Button>\r\n                                    </>\r\n                                    }\r\n                                    {mode === MODE_NEW &&\r\n                                    <>\r\n                                        <Button variant=\"primary\" onClick={() => createSong()}>Create</Button>\r\n                                    </>\r\n                                    }\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n                <div className=\"col-12 col-lg-4\">\r\n                    {(mode === MODE_NEW || (mode === MODE_UPDATE && currentKey)) && <iframe className=\"w-100 h-100\" srcDoc={`<style>${previewStyles}</style><div>${text}</div>`}/>}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","export default function Loader() {\r\n    return (\r\n        <div className=\"lds-ring\">\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n            <div></div>\r\n        </div>\r\n    )\r\n}\r\n","import \"./App.css\";\nimport Dashboard from \"./pages/dashboard/Dashboard\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport React, {useEffect, useState} from \"react\";\nimport {initializeApp} from \"firebase/app\";\nimport {getDatabase} from \"firebase/database\";\nimport Loader from \"./components/Loader\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyB6jgAYZFaJhpzVcoZ9hox6h6iVGq6Ozqo\",\n  authDomain: \"songreader-f7e8c.firebaseapp.com\",\n  databaseURL: \"https://songreader-f7e8c.firebaseio.com\",\n  projectId: \"songreader-f7e8c\",\n  storageBucket: \"songreader-f7e8c.appspot.com\",\n  messagingSenderId: \"703302008821\",\n  appId: \"1:703302008821:web:826c661d4e80de2a732abc\"\n};\n\nconst App = () => {\n  const [db, setDb] = useState(null);\n\n  useEffect(() => {\n    const app = initializeApp(firebaseConfig);\n    const db = getDatabase(app);\n\n    setDb(db);\n  }, []);\n\n  if(!db) {\n    return <Loader/>\n  }\n\n  return (\n      <Dashboard\n          db={db}\n      />\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}